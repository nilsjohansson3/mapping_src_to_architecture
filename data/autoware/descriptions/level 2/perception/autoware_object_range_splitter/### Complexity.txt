This algorithm is O(N).